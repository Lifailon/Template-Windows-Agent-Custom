zabbix_export:
  version: '6.0'
  date: '2022-08-14T22:34:38Z'
  groups:
    -
      uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Windows Server'
  templates:
    -
      uuid: 13b06904a6bf41cbb795e3193d896340
      template: 'Windows Agent Custom'
      name: 'Windows Agent Custom'
      groups:
        -
          name: 'Windows Server'
      items:
        -
          uuid: af550a1bfe74428eb24492d8af3b405e
          name: 'Host name of Zabbix agent running'
          key: agent.hostname
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
        -
          uuid: f81e2ce0d1104f9aaf1fc49284ed0ed4
          name: 'Zabbix agent ping'
          key: agent.ping
          history: 7d
          description: 'The agent always returns 1 for this item. It could be used in combination with nodata() for availability check.'
          valuemap:
            name: 'Zabbix agent ping status'
          tags:
            -
              tag: component
              value: system
        -
          uuid: 5707443d739d4689bde192e75ff4bd0f
          name: 'Version of Zabbix agent running'
          key: agent.version
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: application
        -
          uuid: 63a2a595c41440e392f0bcb01adbf3f3
          name: 'Memory: Available Bytes'
          key: 'perf_counter_en["\Memory\Available Mbytes"]'
          history: 7d
          trends: 30d
          units: B
          description: |
            Memory: Available Bytes
            Порог: Этот счётчик должен быть постоянно выше 5 000 КВ (если не разбираться в нюансах)
            Значение: Отслеживает количество доступной памяти в байтах для выполнения различных процессов.. Низкие показатели означают нехватку памяти. Решение — увеличить память.
            Есть смысл выставлять порог для \Memory\Available Mbytesвручную из соображений:
            •50% свободной памяти доступно = Отлично
            •25% доступно памяти = Требует внимания
            •10% свободно = Возможны проблемы
            •Меньше 5% доступно памяти= Критично для скорости, нужно вмешиваться
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 5219a246de0641a89685a961cdd08c0b
          name: 'Cache bytes'
          key: 'perf_counter_en["\Memory\Cache Bytes"]'
          history: 7d
          units: B
          description: |
            Cache Bytes is the sum of the Memory\\System Cache Resident Bytes, Memory\\System Driver Resident Bytes,
            Memory\\System Code Resident Bytes, and Memory\\Pool Paged Resident Bytes counters. This counter displays
            the last observed value only; it is not an average.
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 732f93a07f8e4fd187562e9a1af49d2e
          name: 'Cache Faults'
          key: 'perf_counter_en["\Memory\Cache Faults"]'
          history: 7d
          trends: 30d
          units: B
          description: 'Cache Faults - учитывает промахи подсистемы кэширования. Таким образом, если \Memory\Pages/sec,\Memory\Page Reads/sec, Memory\Pages Input/sec постоянно находятся на высоком уровне, а \Memory\Cache Faults на низком, то можно предположить, что операционная система активно работает с файлом подкачки, что, в свою очередь, говорит о недостатке памяти.'
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 2ea74fafb9334de095adcb47cced578d
          name: 'Free system page table entries'
          key: 'perf_counter_en["\Memory\Free System Page Table Entries"]'
          history: 7d
          description: |
            This indicates the number of page table entries not currently in use by the system. If the number is less
            than 5,000, there may well be a memory leak or you running out of memory.
          tags:
            -
              tag: component
              value: memory
          triggers:
            -
              uuid: e3118e2e6109460f80cc2d56795ed42f
              expression: 'max(/Windows Agent Custom/perf_counter_en["\Memory\Free System Page Table Entries"],5m)<{$MEM.PAGE_TABLE_CRIT.MIN}'
              name: 'Количество свободных записей в системной таблице страниц (ОЗУ) меньше {$MEM.PAGE_TABLE_CRIT.MIN} в течении 5 минут'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Page Table Entry (PTE) — таблица страниц, это структура данных, используемая системой виртуальной памяти в операционной системе компьютера для хранения сопоставления между виртуальным адресом и физическим адресом. Виртуальные адреса используются выполняющимся процессом, в то время как физические адреса используются аппаратным обеспечением, или, более конкретно, подсистемой ОЗУ. Таблица страниц является ключевым компонентом преобразования виртуальных адресов, который необходим для доступа к данным в памяти. При отгрузке на HDD и при чтении страниц с HDD быстрее получится записать несколько больших страниц, чем много маленьких такого же суммарного размера. Если количество свободных записей в системной таблице страниц меньше 5 000, то возможна утечка памяти.'
              tags:
                -
                  tag: scope
                  value: capacity
        -
          uuid: 6c41d254585a4d7b81a0c5766a8913c1
          name: 'Memory page faults per second'
          key: 'perf_counter_en["\Memory\Page Faults/sec"]'
          history: 7d
          value_type: FLOAT
          description: |
            Page Faults/sec is the average number of pages faulted per second. It is measured in number of pages
            faulted per second because only one page is faulted in each fault operation, hence this is also equal
            to the number of page fault operations. This counter includes both hard faults (those that require
            disk access) and soft faults (where the faulted page is found elsewhere in physical memory.) Most
            processors can handle large numbers of soft faults without significant consequence. However, hard faults,
            which require disk access, can cause significant delays.
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 8d2cc32f12cd44faa3817485c7ef0640
          name: 'Memory page faults per second'
          key: 'perf_counter_en["\Memory\Page Reads/sec"]'
          history: 7d
          trends: 30d
          value_type: FLOAT
          description: 'Счетчик \Memory\Page Reads/sec можно использовать в дополнение к \Memory\Pages/sec. Он показывает, сколько операций чтения в единицу времени, безотносительно к страницам, было сделано при обработке страничных прерываний. Счетчики Memory\Pages Input/sec и \Memory\Page Reads/sec нужно рассматривать совместно. Первый из них содержит количество страниц, прочитанных с диска, а второй — количество операций чтения, совершенных при подкачке.'
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 287163bc5b0441c4bf51489432a278eb
          name: 'Memory pages per second'
          key: 'perf_counter_en["\Memory\Pages/sec"]'
          history: 7d
          value_type: FLOAT
          description: |
            This measures the rate at which pages are read from or written to disk to resolve hard page faults.
            If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.
          tags:
            -
              tag: component
              value: memory
          triggers:
            -
              uuid: ab4c9a66d16f42e6a32f6144f4d2a3ca
              expression: 'min(/Windows Agent Custom/perf_counter_en["\Memory\Pages/sec"],5m)>{$MEM.PAGE_SEC.CRIT.MAX}'
              name: 'Активное использование файла подкачки (Pages/sec выше {$MEM.PAGE_SEC.CRIT.MAX})'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Pages/sec - отображает число страниц, считанные или записанные на диск для разрешения обращения к страницам памяти, которые не были загружены в оперативную память в момент обращения. Эта величина является суммой величин Pages Input/sec и Pages Output/sec. Это основной счетчик, за которым следует следить в том случае, если наблюдается большая нагрузка на использование памяти и связанный с этим избыточный страничный обмен.'
              tags:
                -
                  tag: scope
                  value: capacity
        -
          uuid: fb822cb2a17948208a61bd6661c496df
          name: 'Memory pool non-paged'
          key: 'perf_counter_en["\Memory\Pool Nonpaged Bytes"]'
          history: 7d
          units: B
          description: |
            This measures the size, in bytes, of the non-paged pool. This is an area of system memory for objects
            that cannot be written to disk but instead must remain in physical memory as long as they are allocated.
            There is a possible memory leak if the value is greater than 175MB (or 100MB with the /3GB switch).
            A typical Event ID 2019 is recorded in the system event log.
          tags:
            -
              tag: component
              value: memory
        -
          uuid: b99a722d267d455fad3c07c53302b20f
          name: 'Used swap space in %'
          key: 'perf_counter_en["\Paging file(_Total)\% Usage"]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The used space of swap volume/file in percent.'
          tags:
            -
              tag: component
              value: memory
            -
              tag: component
              value: storage
        -
          uuid: ee1f116fdab34969a6e6f5e1c25fc3d2
          name: 'CPU DPC time'
          key: 'perf_counter_en["\Processor Information(_total)\% DPC Time"]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: |
            Processor DPC time is the time that a single processor spent receiving and servicing deferred procedure
            calls (DPCs). DPCs are interrupts that run at a lower priority than standard interrupts. % DPC Time is a
            component of % Privileged Time because DPCs are executed in privileged mode. If a high % DPC Time is
            sustained, there may be a processor bottleneck or an application or hardware related issue that can
            significantly diminish overall system performance.
          tags:
            -
              tag: component
              value: cpu
        -
          uuid: e403552481b04ebdba2e8a019f114f20
          name: 'CPU interrupt time'
          key: 'perf_counter_en["\Processor Information(_total)\% Interrupt Time"]'
          delay: 10s
          history: 7d
          trends: 30d
          value_type: FLOAT
          units: '%'
          description: |
            The Processor Information\% Interrupt Time is the time the processor spends receiving and servicing
            hardware interrupts during sample intervals. This value is an indirect indicator of the activity of
            devices that generate interrupts, such as the system clock, the mouse, disk drivers, data communication
            lines, network interface cards and other peripheral devices. This is an easy way to identify a potential
            hardware failure. This should never be higher than 20%.
          tags:
            -
              tag: component
              value: cpu
          triggers:
            -
              uuid: f67bedcb282349b2aac052baf4963480
              expression: 'min(/Windows Agent Custom/perf_counter_en["\Processor Information(_total)\% Interrupt Time"],10m)>{$CPU.INTERRUPT.CRIT.MAX}'
              name: 'Прерывания CPU (interrupt time) выше {$CPU.INTERRUPT.CRIT.MAX}% в течении 10 минут'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: 'Interrupt Time - процент времени, которое процессор тратит на обработку аппаратных прерываний от устройств. Большие значения счетчика могут говорить о проблемах с оборудованием. В норме показания не должны выходить за 5% даже при значительной (>50%) нагрузке на ЦП. Это значение является косвенным показателем активности устройств, генерирующих прерывания, таких как системные часы, мышь, драйверы дисков, сетевые интерфейсные карты и другие периферийные устройства. Этот показатель никогда не должен быть выше 20%. Поскольку прерывания принимаются от оборудования, высокие значения косвенно могут свидетельствовать о проблемах с устройствами или с их драйверами.'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: 37448f05afe340a3891d05528c9d1adc
          name: 'CPU privileged time'
          key: 'perf_counter_en["\Processor Information(_total)\% Privileged Time"]'
          delay: 10s
          history: 7d
          trends: 30d
          value_type: FLOAT
          units: '%'
          description: |
            The Processor Information\% Privileged Time counter shows the percent of time that the processor is spent
            executing in Kernel (or Privileged) mode. Privileged mode includes services interrupts inside Interrupt
            Service Routines (ISRs), executing Deferred Procedure Calls (DPCs), Device Driver calls and other kernel-mode
            functions of the Windows® Operating System.
          tags:
            -
              tag: component
              value: cpu
          triggers:
            -
              uuid: 4d099256b3ba42f1b90143e2014900dd
              expression: 'min(/Windows Agent Custom/perf_counter_en["\Processor Information(_total)\% Privileged Time"],10m)>{$CPU.PRIV.CRIT.MAX}'
              name: 'Запросы ядра на CPU (privileged time) выше {$CPU.PRIV.CRIT.MAX}% в течении 10 минут'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: '% Privileged Time — отображает процент времени, которое процессор затрачивает на обработку запросов ядра, т.е. выполняет код в привилегированном режиме, все функции ОС работают именно в этом режиме. Не должно быть ситуации, когда работа в привилегированном режиме превышает 10%. При значениях выше 20% нужно анализировать показания счетчиков % User Time, % Interrupt Time и % DPC Time.'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: 575912d512624143b564ca0fbfd0bb8f
          name: 'CPU user time'
          key: 'perf_counter_en["\Processor Information(_total)\% User Time"]'
          delay: 10s
          history: 7d
          trends: 30d
          value_type: FLOAT
          units: '%'
          description: |
            The Processor Information\% User Time counter shows the percent of time that the processor(s) is spent executing
            in User mode.
          tags:
            -
              tag: component
              value: cpu
        -
          uuid: 2322a85bfc1049a3b5c892d83b5d5054
          name: 'Context switches per second'
          key: 'perf_counter_en["\System\Context Switches/sec"]'
          history: 7d
          value_type: FLOAT
          description: |
            Context Switches/sec is the combined rate at which all processors on the computer are switched from one thread to another.
            Context switches occur when a running thread voluntarily relinquishes the processor, is preempted by a higher priority ready thread, or switches between user-mode and privileged (kernel) mode to use an Executive or subsystem service.
            It is the sum of Thread\\Context Switches/sec for all threads running on all processors in the computer and is measured in numbers of switches.
            There are context switch counters on the System and Thread objects. This counter displays the difference between the values observed in the last two samples, divided by the duration of the sample interval.
          tags:
            -
              tag: component
              value: cpu
        -
          uuid: 002af28df72f4a788c88bc022d88c6dd
          name: 'CPU queue length'
          key: 'perf_counter_en["\System\Processor Queue Length"]'
          delay: 30s
          history: 7d
          trends: 30d
          value_type: FLOAT
          description: |
            The Processor Queue Length shows the number of threads that are observed as delayed in the processor Ready Queue
            and are waiting to be executed.
          tags:
            -
              tag: component
              value: cpu
        -
          uuid: 630b7b2af6274936ab80b1dd774113e5
          name: 'Number of threads'
          key: 'perf_counter_en["\System\Threads"]'
          history: 7d
          description: 'The number of threads used by all running processes.'
          tags:
            -
              tag: component
              value: os
        -
          uuid: b305029532f84daf93c8da2d181ac3a1
          name: 'Number of processes'
          key: 'proc.num[]'
          history: 7d
          description: 'The number of processes.'
          tags:
            -
              tag: component
              value: os
          triggers:
            -
              uuid: 530de3c9865e46389f5bad1a784e83dd
              expression: 'min(/Windows Agent Custom/proc.num[],5m)>{$PROC.CRIT}'
              name: 'Количество активных процессов выше {$PROC.CRIT}'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: WARNING
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: c2ed8e2efab04564b6c70ee8ad14730f
          name: 'CPU utilization'
          key: system.cpu.util
          delay: 10s
          history: 7d
          trends: 30d
          value_type: FLOAT
          units: '%'
          description: 'CPU utilization in %.'
          tags:
            -
              tag: component
              value: cpu
          triggers:
            -
              uuid: 806aa232f56640ab98aacc79491fc4d7
              expression: 'min(/Windows Agent Custom/system.cpu.util,5m)>{$CPU.UTIL.CRIT}'
              name: 'Загрузка процессора выше {$CPU.UTIL.CRIT}% в течение 5 минут'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'минуты (элемент данных в течение пяти минут) больше макроса критического значения'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: cb056886ce72426e833a0445f9263906
          name: 'System name'
          key: system.hostname
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'System host name.'
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 6b50d36a4e29468a9546e880f3004399
              expression: 'last(/Windows Agent Custom/system.hostname,#1)<>last(/Windows Agent Custom/system.hostname,#2) and length(last(/Windows Agent Custom/system.hostname))>0'
              name: 'Изменилось имя сервера, новое имя: {ITEM.VALUE}'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: WARNING
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 94c4dfe23e2e4c6e995a3a715941a8eb
          name: 'System local time'
          key: system.localtime
          history: 7d
          units: unixtime
          description: 'System local time of the host.'
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 37ca2366c8474cc8a49a605e93377601
              expression: 'fuzzytime(/Windows Agent Custom/system.localtime,{$SYSTEM.FUZZYTIME.MAX})=0'
              name: 'Ошибка синхронизация системного времени. Разница с сервером Zabbix:  {$SYSTEM.FUZZYTIME.MAX}s)'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: WARNING
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 7e8b3476db6d4322a10cd1a28cbdb7ea
          name: 'Operating system architecture'
          key: system.sw.arch
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Operating system architecture of the host.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: os
        -
          uuid: 11cac38334544e5cbb028cfd473cb39e
          name: 'Free swap space'
          type: CALCULATED
          key: system.swap.free
          history: 7d
          units: B
          params: 'last(//system.swap.size[,total]) - last(//system.swap.size[,total]) / 100 * last(//perf_counter_en["\Paging file(_Total)\% Usage"])'
          description: 'The free space of swap volume/file in bytes.'
          tags:
            -
              tag: component
              value: memory
            -
              tag: component
              value: storage
        -
          uuid: 9c7e3c843a3045df81dddc5d18de267c
          name: 'Free swap space in %'
          type: DEPENDENT
          key: system.swap.pfree
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The free space of swap volume/file in percent.'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - 'return (100 - value)'
          master_item:
            key: 'perf_counter_en["\Paging file(_Total)\% Usage"]'
          tags:
            -
              tag: component
              value: memory
            -
              tag: component
              value: storage
        -
          uuid: f981835baf04494eaff2f33f159e0ab5
          name: 'Total swap space'
          key: 'system.swap.size[,total]'
          history: 7d
          units: B
          description: 'The total space of swap volume/file in bytes.'
          tags:
            -
              tag: component
              value: memory
            -
              tag: component
              value: storage
        -
          uuid: b103a2c22fe344f886e9dc9f4e4a65ec
          name: 'System description'
          key: system.uname
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'System description of the host.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
        -
          uuid: 12503fbf4400488e9b5ff0488f164cb6
          name: Uptime
          key: system.uptime
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: 'System uptime in ''N days, hh:mm:ss'' format.'
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: d27b9eab4034439f91dff41fe6f043ab
              expression: 'last(/Windows Agent Custom/system.uptime)<10m'
              name: 'Сервер был перезагружен (время работы меньше 10 минут)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 09e9a345a0f445b1a65685911f5eb9b0
          name: 'Total memory'
          key: 'vm.memory.size[total]'
          delay: 10s
          history: 7d
          trends: 30d
          units: B
          description: 'Total memory in Bytes.'
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 1cbf45e11dab453797fe291639aa0c01
          name: 'Used memory'
          key: 'vm.memory.size[used]'
          delay: 10s
          history: 7d
          trends: 30d
          units: B
          description: 'Used memory in Bytes.'
          tags:
            -
              tag: component
              value: memory
        -
          uuid: 3b1e4ecaa04a46e9b0aee956918f0713
          name: 'Memory utilization'
          type: CALCULATED
          key: vm.memory.util
          delay: 10s
          history: 7d
          trends: 30d
          value_type: FLOAT
          units: '%'
          params: 'last(//vm.memory.size[used]) / last(//vm.memory.size[total]) * 100'
          description: 'Memory utilization in %.'
          tags:
            -
              tag: component
              value: memory
          triggers:
            -
              uuid: b442993bb2a6404a8ebcb7be39d16ce6
              expression: 'min(/Windows Agent Custom/vm.memory.util,5m)>{$MEMORY.UTIL.MAX}'
              name: 'Загрузка оперативной памяти выше {$MEMORY.UTIL.MAX}% в течение 5 минут'
              opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'минуты (элемент данных в течение пяти минут) больше {макроса критического значения}'
              tags:
                -
                  tag: scope
                  value: capacity
                -
                  tag: scope
                  value: performance
        -
          uuid: 08b70a5b80fd435ba393e3deb3ca5adb
          name: 'Network interfaces WMI get'
          key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
          history: '0'
          trends: '0'
          value_type: TEXT
          description: win32_networkadapter
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: raw
        -
          uuid: 83c8c6f15b524a2fb04fc90d04d3e8a2
          name: 'Number of cores'
          key: 'wmi.get[root/cimv2,"Select NumberOfLogicalProcessors from Win32_ComputerSystem"]'
          history: 7d
          description: 'The number of logical processors available on the computer.'
          tags:
            -
              tag: component
              value: cpu
        -
          uuid: 3dcb0f79342b4ded97cdec0794472266
          name: 'Zabbix agent availability'
          type: INTERNAL
          key: 'zabbix[host,agent,available]'
          history: 7d
          description: 'Monitoring agent availability status'
          valuemap:
            name: zabbix.host.available
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 05beb4500cae480892fad0739f99807d
              expression: 'max(/Windows Agent Custom/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0'
              name: 'Агент Zabbix недоступен в течении {$AGENT.TIMEOUT} минут'
              priority: WARNING
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: availability
      discovery_rules:
        -
          uuid: ba19d6566fdb4a668d4363769d1fee01
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: E
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: C
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: A
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of installed network interfaces.'
          item_prototypes:
            -
              uuid: 8a7bb1e8afd24d32a65fa2116ba439ce
              name: 'Interface {#IFNAME}({#IFALIAS}): отброшенных входящих пакетов (drop)'
              key: 'net.if.in["{#IFGUID}",dropped]'
              delay: 3m
              history: 7d
              description: 'Количество входящих пакетов, отброшенных на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 6e1f3dfb91024095a20870ee94d01822
              name: 'Interface {#IFNAME}({#IFALIAS}): входящие пакеты с ошибками'
              key: 'net.if.in["{#IFGUID}",errors]'
              delay: 3m
              history: 7d
              description: 'Количество входящих пакетов с ошибками на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 82accc942f5747a2b399484466625051
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received (входящий)'
              key: 'net.if.in["{#IFGUID}"]'
              delay: 30s
              history: 7d
              trends: 30d
              units: bps
              description: 'Входящий трафик на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 9ddb9aaf863a45c0affbd90e4a6fa393
              name: 'Interface {#IFNAME}({#IFALIAS}): отброшенных исходящих пакетов (drop)'
              key: 'net.if.out["{#IFGUID}",dropped]'
              delay: 3m
              history: 7d
              description: 'Количество исходящих пакетов, отброшенных на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 38c8a1aa95b343e39e23e7b508521dad
              name: 'Interface {#IFNAME}({#IFALIAS}): исходящие пакеты с ошибками'
              key: 'net.if.out["{#IFGUID}",errors]'
              delay: 3m
              history: 7d
              description: 'Количество исходящих пакетов с ошибками на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 3b090da19af842189bb6fa56d49ceec3
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent (исходящий)'
              key: 'net.if.out["{#IFGUID}"]'
              delay: 30s
              history: 7d
              trends: 30d
              units: bps
              description: 'Исходящий трафик на сетевом интерфейсе.'
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 0445b842d1ce4c7f9fd5716c78a079c4
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed["{#IFGUID}"]'
              delay: '0'
              history: 7d
              trends: '0'
              units: bps
              description: 'Расчетная пропускная способность сетевого интерфейса, если таковая имеется.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].Speed.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return (value==''9223372036854775807'' ? 0 : value)'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: c495bffb7e244e5caf5dc013d839b758
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status["{#IFGUID}"]'
              delay: '0'
              history: 7d
              trends: '0'
              description: 'Статус сетевого интерфейса.'
              valuemap:
                name: 'Win32_NetworkAdapter::NetConnectionStatus'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].NetConnectionStatus.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                -
                  uuid: a9b1c61ac4a6481aab93d40c6fb93462
                  expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])<>2 and  {$IFCONTROL:"{#IFNAME}"}=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): недоступен'
                  opdata: 'Текущее состояние: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    Триггер срабатывает, только если рабочий статус отличается от Connected(2).
                    {$IFCONTROL:\"{#IFNAME}\"}=1 - пользователь может переопределить макрос Context в значение - 0. Это помечает данный интерфейс как неважный. Никакой новый триггер не будет срабатывать, если этот интерфейс не работает.
                    Если триггер закрыт вручную - он не сработает при следующем опросе из-за .diff.
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: availability
            -
              uuid: 11ce3d38745a49f58f713fcef1a913c5
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type["{#IFGUID}"]'
              delay: '0'
              history: 7d
              trends: '0'
              description: 'Тип сетевого интерфейса.'
              valuemap:
                name: 'Win32_NetworkAdapter::AdapterTypeId'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].AdapterTypeId.first()'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                -
                  tag: component
                  value: network
                -
                  tag: description
                  value: '{#IFALIAS}'
                -
                  tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            -
              uuid: b2191521a7a54985a19740e3ee2674f2
              expression: |
                change(/Windows Agent Custom/net.if.speed["{#IFGUID}"])<0 and
                last(/Windows Agent Custom/net.if.speed["{#IFGUID}"])>0 and
                last(/Windows Agent Custom/net.if.status["{#IFGUID}"])=2
              name: 'Изменилась скорость сетевого интерфейса {#IFNAME}({#IFALIAS})'
              opdata: '{ITEM.LASTVALUE1}'
              priority: INFO
              description: 'Это Ethernet-соединение снизило свою скорость по сравнению с известной максимальной скоростью. Это может быть признаком проблем с автосогласованием.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): недоступен'
                  expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])<>2 and  {$IFCONTROL:"{#IFNAME}"}=1'
                  recovery_expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: capacity
            -
              uuid: c93048183c3942808c60d6dd61963bc0
              expression: |
                (avg(/Windows Agent Custom/net.if.in["{#IFGUID}"],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Windows Agent Custom/net.if.speed["{#IFGUID}"]) or
                avg(/Windows Agent Custom/net.if.out["{#IFGUID}"],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Windows Agent Custom/net.if.speed["{#IFGUID}"])) and
                last(/Windows Agent Custom/net.if.speed["{#IFGUID}"])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Windows Agent Custom/net.if.in["{#IFGUID}"],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Windows Agent Custom/net.if.speed["{#IFGUID}"]) and
                avg(/Windows Agent Custom/net.if.out["{#IFGUID}"],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Windows Agent Custom/net.if.speed["{#IFGUID}"])
              name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): высокая пропускная способность'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Использование сетевого интерфейса близко к его расчетной максимальной пропускной способности.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): недоступен'
                  expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])<>2 and  {$IFCONTROL:"{#IFNAME}"}=1'
                  recovery_expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: performance
            -
              uuid: a4fa6e161bb64b98b25b1a2a501a83f4
              expression: |
                min(/Windows Agent Custom/net.if.in["{#IFGUID}",errors],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Windows Agent Custom/net.if.out["{#IFGUID}",errors],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Windows Agent Custom/net.if.in["{#IFGUID}",errors],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Windows Agent Custom/net.if.out["{#IFGUID}",errors],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): ошибки пакетов выше {$IF.ERRORS.WARN:"{#IFNAME}"} в течении 5 минут'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Восстанавливается при превышении 80% порога {$IF.ERRORS.WARN:"{#IFNAME}"}.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Сетевой интерфейс {#IFNAME}({#IFALIAS}): недоступен'
                  expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])<>2 and  {$IFCONTROL:"{#IFNAME}"}=1'
                  recovery_expression: 'last(/Windows Agent Custom/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: availability
          graph_prototypes:
            -
              uuid: 5cbfad75590746718cf4eabbeeea43f3
              name: 'Interface {#IFNAME}({#IFALIAS}): ошибки и потери пакетов'
              graph_items:
                -
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.out["{#IFGUID}",errors]'
                -
                  sortorder: '1'
                  color: FF0080
                  yaxisside: RIGHT
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.in["{#IFGUID}",errors]'
                -
                  sortorder: '2'
                  color: 0040FF
                  yaxisside: RIGHT
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.out["{#IFGUID}",dropped]'
                -
                  sortorder: '3'
                  color: 00FFFF
                  yaxisside: RIGHT
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.in["{#IFGUID}",dropped]'
            -
              uuid: 59e9c744c0454023a36ecc7d95f4a9ec
              name: 'Interface {#IFNAME}({#IFALIAS}): сетевой трафик'
              graph_items:
                -
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.in["{#IFGUID}"]'
                -
                  sortorder: '1'
                  color: FFFF00
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'net.if.out["{#IFGUID}"]'
          master_item:
            key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  output = JSON.parse(value).map(function(net){
                      return {
                          "{#IFNAME}": net.Name,
                          "{#IFDESCR}": net.Description,
                          "{#IFALIAS}": net.NetConnectionID,
                          "{#IFGUID}": net.GUID
                      }})
                  return JSON.stringify({"data": output})
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          uuid: 8f155ebc6fd045b3b7548010af1a73c7
          name: 'Physical disks discovery'
          key: 'perf_instance_en.discovery[PhysicalDisk]'
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of installed physical disks.'
          item_prototypes:
            -
              uuid: 821f46bbf9d7432e9ea0d5f93a868269
              name: '{#DEVNAME}: Disk Time Util'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              units: '%'
              description: 'Этот пункт представляет собой процент времени, в течение которого выбранный дисковый накопитель был занят обслуживанием запросов на чтение или запись, исходя из времени простоя (деление на Idle Time).'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 4777fa000fa9460baab1fd7bc7e40604
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60],15m)>{$VFS.DEV.UTIL.MAX.WARN}'
                  name: '{#DEVNAME}: Загрузка диска выше {$VFS.DEV.UTIL.MAX.WARN} в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 77e33448596a498ba211d23a1977e9ca
              name: '{#DEVNAME}: Avg. Disk Read Queue Length (средняя длина очереди диска на чтение)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              description: 'Средняя очередь на чтение с диска'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 74492cd1a83e4dbb9861b3a60e8b9ec0
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length",60],15m) > 10'
                  name: '{#DEVNAME}: Очередь чтения выше 10 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 7d91ed70bc3b4ef2a7991b3a5ba3bde4
              name: '{#DEVNAME}: Avg. Disk sec/Read (среднее время задержки обращения чтения данных с диска)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              units: s
              description: 'Avg. Disk sec/Read - среднее время обращения на чтения данных с диска в секундах. Среднее значение счетчика производительности Avg. Disk sec/Read не должно превышать 10 миллисекунд (0,01 сек). Максимальное значение счетчика производительности Avg. Disk sec/Read не должно превышать 50 миллисекунд. 1 сек. = 1000 мс.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 85a8c002b3d84121ad2e73c8aced0987
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60],15m) > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"}'
                  name: '{#DEVNAME}: Задержка чтения больше {$VFS.DEV.READ.AWAIT.WARN} мс в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: ad32cf85df71486b89ab3f8b8e0b8a19
              name: '{#DEVNAME}: Avg. Disk sec/Transfer (среднее время задержки обращений к диску в секундах)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Transfer",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              description: 'Avg. Disk sec/Transfer - среднее время задержки обращения к диску в секундах, требуемое для выполнения диском одной операции чтения или записи. Сумма значений Avg. Disk sec/Read (время на выполнение операции чтения) и Avg. Disk sec/Write (время на выполнение операции записи). Для высоконагруженых систем, таких как сервера БД, значение Avg. Disk sec/Transfer не должно превышать 0,1, для рядовых серверов допустимо значение 0,25.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: bb6f493caa7349c49828cb1d78b446b6
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Transfer",60],15m) > {$VFS.DEV.TRANSFER.AWAIT.WARN:"{#DEVNAME}"}'
                  name: '{#DEVNAME}: Задержка обращений к диску выше {$VFS.DEV.TRANSFER.AWAIT.WARN} мс в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: DISASTER
                  description: Добавлено
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 898784d050664f8eaf197ebebc16077e
              name: '{#DEVNAME}: Avg. Disk sec/Write (среднее время задержки обращения записи данных на диск)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              units: s
              description: 'Avg. Disk sec/Write - среднее время обращения записи данных на диск в секундах.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: db6809fd85e241948fb5ef76cb7cc17b
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60],15m) > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}'
                  name: '{#DEVNAME}: Задержка записи больше {$VFS.DEV.WRITE.AWAIT.WARN} мс в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 71a2c065efaa437fb7296972f516bd82
              name: '{#DEVNAME}: Avg. Disk Write Queue Length (средняя длина очереди диска на запись)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              description: 'Средняя очередь записи на диск'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 6d38896c9b9f44faa29a092f7bc4ef31
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length",60],15m) > 10'
                  name: '{#DEVNAME}: Очередь записи выше 10 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: b49884669dbf43cc95ea3d27fb23698c
              name: '{#DEVNAME}: Current Disk Queue Length (текущая длина очереди запросов к диску)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Current Disk Queue Length",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              description: 'Current Disk Queue Length - текущая длина очереди запросов к диску. Показывает количество запросов, ожидающих обработки в данный конкретный момент.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 408d02423e0946398bd705539c7df197
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Current Disk Queue Length",60],15m) > 15'
                  name: '{#DEVNAME}: Очередь запросов к диску выше 15 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 390c6e4f2c134ae2939810892eefd6f7
              name: '{#DEVNAME}: Disk Reads/sec (IOPS количество обращений чтения в секунду)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Reads/sec",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              units: '!r/s'
              description: 'Disk Reads/sec — количество обращений чтения в секунду. В нормальном режиме интенсивность обращений не должна превышать их индивидуальным пределам, умноженным на количество дисков в массиве. В режиме чтения для различных типов RAID могут учитываться не все диски, например в RAID-6 в массиве из шести дисков скорость чтения равна скорости чтения с четырех дисков (с оставшихся двух считываются контрольные суммы).'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: a3ab059432a8487d927e4300aca90903
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Reads/sec",60],15m) > 1000'
                  name: '{#DEVNAME}: IOPS reads выше 1000 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Операций чтения с диска в секунду'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 2aed72661c0048e18a93e50dc9ce51c8
              name: '{#DEVNAME}: Disk Transfers/sec (IOPS - общее количество операций ввода\вывода, завершенных диском в течении 1 секунды)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Transfers/sec",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              description: 'Disk Transfers/sec - общее количество операций ввода\вывода, обработанных (завершенных) диском в течении 1 секунды (Input/Output Operations Per Second, IOPS). Этот счетчик позволяет примерно оценить, насколько нагрузка на диски близка к предельной (зная этот показатель). Для дисков, работающих в нормальном режиме, можно ориентироваться на следующие значения: 80-160 IOPS для одиночного жесткого диска SATA или SAS, 1800-5000 IOPS для одиночного SSD диска.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 9b3c197e1d014175aff73f916997c173
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Transfers/sec",60],15m) > 2000'
                  name: '{#DEVNAME}: IOPS выше 2000 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
            -
              uuid: 6353d621a9c4415c94247208fc996075
              name: '{#DEVNAME}: Disk Writes/sec (IOPS количество обращений записи в секунду)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Writes/sec",60]'
              delay: 10s
              history: 7d
              trends: 30d
              value_type: FLOAT
              units: '!w/s'
              description: 'Disk Writes/sec — количество обращений записи в секунду, то есть частота выполнения операций записи на диск.'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                -
                  uuid: 8a3cf4593dff414a848bd293864dade2
                  expression: 'min(/Windows Agent Custom/perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Writes/sec",60],15m) > 1000'
                  name: '{#DEVNAME}: IOPS writes выше 1000 в течении 15 минут'
                  opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Операция записи на диск в секунду'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: performance
          graph_prototypes:
            -
              uuid: ab2af653778c403dbbdcdadac8339cc7
              name: '{#DEVNAME}: Disk Idle Time'
              graph_items:
                -
                  color: 00FF00
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60]'
            -
              uuid: 410aa91b06474fc881fc14d64f1d3ab0
              name: '{#DEVNAME}: IOPS Transfers'
              graph_items:
                -
                  drawtype: BOLD_LINE
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Transfers/sec",60]'
            -
              uuid: 339a20ba0d3f4ba4a05aee0611124819
              name: '{#DEVNAME}: Количество обращений чтения и записи в секунду (IOPS)'
              graph_items:
                -
                  color: FFFF00
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Reads/sec",60]'
                -
                  sortorder: '1'
                  color: FF4000
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Writes/sec",60]'
            -
              uuid: bc71dc24634742028a5c8384dcaa0f32
              name: '{#DEVNAME}: Очередь'
              graph_items:
                -
                  color: FF0000
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Current Disk Queue Length",60]'
            -
              uuid: fa5f02da91794b57a00a288d425d7f61
              name: '{#DEVNAME}: Очередь чтения и записи'
              graph_items:
                -
                  color: BF00FF
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length",60]'
                -
                  sortorder: '1'
                  color: FFFF00
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length",60]'
            -
              uuid: f54bdfb7e0c7471f80b8ca599bc4f904
              name: '{#DEVNAME}: Среднее время задержки чтения и записи данных с диска в секундах'
              graph_items:
                -
                  color: FFFF00
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60]'
                -
                  sortorder: '1'
                  color: FF4000
                  item:
                    host: 'Windows Agent Custom'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60]'
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - '{#INSTANCE}'
                - '{#DEVNAME}'
        -
          uuid: c22b79b52f9148728095bda2796a753e
          name: 'Mounted filesystem discovery'
          key: vfs.fs.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
                formulaid: E
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: C
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#FSDRIVETYPE}'
                value: '{$VFS.FS.FSDRIVETYPE.MATCHES}'
                formulaid: A
              -
                macro: '{#FSDRIVETYPE}'
                value: '{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Обнаружение файловых систем.'
          item_prototypes:
            -
              uuid: 6b53c9169c95487ea5bbe524cdf9c118
              name: '{#FSLABEL}({#FSNAME}): Free space'
              key: 'vfs.fs.size[{#FSNAME},free]'
              history: 7d
              units: B
              description: 'Полный размер раздела диска в байтах'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                -
                  uuid: 900661f04b8949389019aebc5c4ed2c9
                  expression: 'last(/Windows Agent Custom/vfs.fs.size[{#FSNAME},free])<2G'
                  name: '({#FSNAME}): Размер диска меньше 2 Гб'
                  opdata: 'Свободного места на диске: {ITEM.LASTVALUE1}'
                  priority: DISASTER
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: 70cbbc1e656f4dee9295d16b78a0dd03
                  expression: 'last(/Windows Agent Custom/vfs.fs.size[{#FSNAME},free])<5G'
                  name: '({#FSNAME}): Размер диска меньше 5 Гб'
                  opdata: 'Свободного места на диске: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: 4d4df7e2971e4a6f8ebdbb1b270eea67
                  expression: 'last(/Windows Agent Custom/vfs.fs.size[{#FSNAME},free])<10G'
                  name: '({#FSNAME}): Размер диска меньше 10 Гб'
                  opdata: 'Свободного места на диске: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
            -
              uuid: ac110c972c2a4cecac1b54dbe15725f2
              name: '{#FSLABEL}({#FSNAME}): Space free'
              key: 'vfs.fs.size[{#FSNAME},pfree]'
              history: 7d
              value_type: FLOAT
              units: '%'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: 7bf3bd42cdf444389e6953090900c620
              name: '{#FSLABEL}({#FSNAME}): Space utilization'
              key: 'vfs.fs.size[{#FSNAME},pused]'
              history: 7d
              value_type: FLOAT
              units: '%'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                -
                  uuid: 643c7d7fc29748d8874d4cdc7a16ba7b
                  expression: 'last(/Windows Agent Custom/vfs.fs.size[{#FSNAME},pused])>95'
                  name: '({#FSNAME}): Объем диска ниже 5%'
                  opdata: 'Текущий процент используемого объем диска: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: '(путь до элемента данных - /шаблон/ключ) больше 95%'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
                -
                  uuid: 608972efb60f4e538d938b06df2f132d
                  expression: 'last(/Windows Agent Custom/vfs.fs.size[{#FSNAME},pused])>90'
                  name: '({#FSNAME}): Объем диска ниже 10%'
                  opdata: 'Текущий процент используемого объем диска: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: '(путь до элемента данных - /шаблон/ключ) больше 90%'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
            -
              uuid: 69378521b7e844ec89afe753a7cba30e
              name: '{#FSLABEL}({#FSNAME}): Total space'
              key: 'vfs.fs.size[{#FSNAME},total]'
              history: 7d
              units: B
              description: 'Полный размер раздела диска в байтах'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: a29509b4b7f24c25a768e88e0c23c154
              name: '{#FSLABEL}({#FSNAME}): Used space'
              key: 'vfs.fs.size[{#FSNAME},used]'
              history: 7d
              units: B
              description: 'Свободное место на разделе диска в байтах'
              tags:
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
          graph_prototypes:
            -
              uuid: 93fa3d3291b3450c877a61676037d906
              name: 'Использование диска: {#FSLABEL}({#FSNAME})'
              width: '600'
              height: '340'
              show_work_period: 'NO'
              show_triggers: 'NO'
              ymin_type_1: FIXED
              ymax_type_1: ITEM
              ymax_item_1:
                host: 'Windows Agent Custom'
                key: 'vfs.fs.size[{#FSNAME},total]'
              graph_items:
                -
                  drawtype: FILLED_REGION
                  color: 80FF00
                  calc_fnc: ALL
                  item:
                    host: 'Windows Agent Custom'
                    key: 'vfs.fs.size[{#FSNAME},used]'
      tags:
        -
          tag: class
          value: os
        -
          tag: target
          value: windows
      macros:
        -
          macro: '{$AGENT.TIMEOUT}'
          value: 3m
          description: 'Таймаут, по истечении которого агент считается недоступным. Работает только для агентов, достижимых с сервера Zabbix (пассивный режим).'
        -
          macro: '{$CPU.INTERRUPT.CRIT.MAX}'
          value: '5'
          description: 'Порог счетчика процессорного времени аппаратных прерываний в %.'
        -
          macro: '{$CPU.PRIV.CRIT.MAX}'
          value: '20'
          description: 'Порог счетчика в привилегированном режиме (нагрузки ядра ОС) времени в %.'
        -
          macro: '{$CPU.QUEUE.CRIT.MAX}'
          value: '3'
          description: 'Порог счетчика длины очереди процессора.'
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
          description: 'Загрузка процессора в %'
        -
          macro: '{$IF.ERRORS.WARN}'
          value: '2'
        -
          macro: '{$IF.UTIL.MAX}'
          value: '90'
        -
          macro: '{$IFCONTROL}'
          value: '1'
        -
          macro: '{$MEM.PAGE_SEC.CRIT.MAX}'
          value: '1000'
          description: 'Порог предупреждения для счетчика страниц оперативной памяти в секунду.'
        -
          macro: '{$MEM.PAGE_TABLE_CRIT.MIN}'
          value: '5000'
          description: 'Порог предупреждения для счетчика Free System Page Table Entries.'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '98'
          description: 'Загрузка оперативной памяти в %'
        -
          macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_THIS
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_THIS
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: Miniport|Virtual|Teredo|Kernel|Loopback|Bluetooth|HTTPS|6to4|QoS|Layer
          description: 'Макрос используется при обнаружении сетевого интерфейса.'
        -
          macro: '{$PROC.CRIT}'
          value: '300'
          description: 'Кол-во активных процессов'
        -
          macro: '{$SERVICE.NAME.MATCHES}'
          value: '^.*$'
          description: 'Макрос используется при обнаружении службы.'
        -
          macro: '{$SERVICE.NAME.NOT_MATCHES}'
          value: '^(?:RemoteRegistry|MMCSS|gupdate|SysmonLog|clr_optimization_v.+|sppsvc|gpsvc|Pml Driver HPZ12|Net Driver HPZ12|MapsBroker|IntelAudioService|Intel\(R\) TPM Provisioning Service|dbupdate|DoSvc|CDPUserSvc_.+|WpnUserService_.+|OneSyncSvc_.+|WbioSrvc|BITS|tiledatamodelsvc|GISvc|ShellHWDetection|TrustedInstaller|TabletInputService|CDPSvc|wuauserv)$'
          description: 'Макрос используется при обнаружении службы.'
        -
          macro: '{$SERVICE.STARTUPNAME.MATCHES}'
          value: '^(?:automatic|automatic delayed)$'
          description: 'Макрос используется при обнаружении службы.'
        -
          macro: '{$SERVICE.STARTUPNAME.NOT_MATCHES}'
          value: '^(?:manual|disabled)$'
          description: 'Макрос используется при обнаружении службы.'
        -
          macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '20'
          description: 'Файл подкачки'
        -
          macro: '{$SYSTEM.FUZZYTIME.MAX}'
          value: '60'
          description: 'Порог разницы системного времени в секундах'
        -
          macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении физических дисков.'
        -
          macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: _Total
          description: 'Макрос используется при обнаружении физических дисков.'
        -
          macro: '{$VFS.DEV.READ.AWAIT.WARN}'
          value: '0.05'
          description: 'Среднее время чтения данных с диска в секундах до срабатывания триггера.'
        -
          macro: '{$VFS.DEV.TRANSFER.AWAIT.WARN}'
          value: '0.10'
          description: 'Задержка обращений к диску в секундах'
        -
          macro: '{$VFS.DEV.UTIL.CRIT.WARN}'
          value: '99'
          description: 'Критическое значение использования дискового времени в %'
        -
          macro: '{$VFS.DEV.UTIL.MAX.WARN}'
          value: '95'
          description: 'Порог предупреждения об использовании дискового времени в процентах.'
        -
          macro: '{$VFS.DEV.WRITE.AWAIT.WARN}'
          value: '0.05'
          description: 'Среднее время записи данных с диска в секундах до срабатывания триггера.'
        -
          macro: '{$VFS.FS.FREE.MIN.CRIT}'
          value: 5G
          description: 'Критический порог свободного места на диске в ГБ'
        -
          macro: '{$VFS.FS.FREE.MIN.WARN}'
          value: 10G
          description: 'Порог предупреждения свободного места на диске в ГБ'
        -
          macro: '{$VFS.FS.FSDRIVETYPE.MATCHES}'
          value: fixed
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: '^(?:/dev|/sys|/run|/proc|.+/shm$)'
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: '.*'
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'Макрос используется при обнаружении файловых систем (разделов диски).'
        -
          macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '95'
          description: 'Критический порог свободного места на диске в %'
        -
          macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '90'
          description: 'Порог предупреждения свободного места на диске в %'
      dashboards:
        -
          uuid: 49212562a208434d9766aa82240230fd
          name: 'Network interfaces'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: 'Interface {#IFNAME}({#IFALIAS}): ошибки и потери пакетов'
        -
          uuid: 5f494fac9dc94bf3827b67ea212240f2
          name: 'System performance'
          pages:
            -
              widgets:
                -
                  type: GRAPH_CLASSIC
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: CPU
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '1'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'Windows Agent Custom'
                        key: 'perf_counter_en["\System\Processor Queue Length"]'
                -
                  type: GRAPH_CLASSIC
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: 'Memory pages'
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '10'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '15'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: '{#DEVNAME}: Количество обращений чтения и записи в секунду (IOPS)'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '20'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: '{#DEVNAME}: Очередь'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '25'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'Windows Agent Custom'
                        name: 'Interface {#IFNAME}({#IFALIAS}): ошибки и потери пакетов'
      valuemaps:
        -
          uuid: 9b087b9bfa09434ea0d0b5c32577abcc
          name: 'Win32_NetworkAdapter::AdapterTypeId'
          mappings:
            -
              value: '0'
              newvalue: 'Ethernet 802.3'
            -
              value: '1'
              newvalue: 'Token Ring 802.5'
            -
              value: '2'
              newvalue: 'Fiber Distributed Data Interface (FDDI)'
            -
              value: '3'
              newvalue: 'Wide Area Network (WAN)'
            -
              value: '4'
              newvalue: LocalTalk
            -
              value: '5'
              newvalue: 'Ethernet using DIX header format'
            -
              value: '6'
              newvalue: ARCNET
            -
              value: '7'
              newvalue: 'ARCNET (878.2)'
            -
              value: '8'
              newvalue: ATM
            -
              value: '9'
              newvalue: Wireless
            -
              value: '10'
              newvalue: 'Infrared Wireless'
            -
              value: '11'
              newvalue: Bpc
            -
              value: '12'
              newvalue: CoWan
            -
              value: '13'
              newvalue: '1394'
        -
          uuid: 7e549195e83446228db8bf1101bea83d
          name: 'Win32_NetworkAdapter::NetConnectionStatus'
          mappings:
            -
              value: '0'
              newvalue: Disconnected
            -
              value: '1'
              newvalue: Connecting
            -
              value: '2'
              newvalue: Connected
            -
              value: '3'
              newvalue: Disconnecting
            -
              value: '4'
              newvalue: 'Hardware Not Present'
            -
              value: '5'
              newvalue: 'Hardware Disabled'
            -
              value: '6'
              newvalue: 'Hardware Malfunction'
            -
              value: '7'
              newvalue: 'Media Disconnected'
            -
              value: '8'
              newvalue: Authenticating
            -
              value: '9'
              newvalue: 'Authentication Succeeded'
            -
              value: '10'
              newvalue: 'Authentication Failed'
            -
              value: '11'
              newvalue: 'Invalid Address'
            -
              value: '12'
              newvalue: 'Credentials Required'
        -
          uuid: 3f685167f97c492598ad445fc938560f
          name: 'Windows service state'
          mappings:
            -
              value: '0'
              newvalue: Running
            -
              value: '1'
              newvalue: Paused
            -
              value: '2'
              newvalue: 'Start pending'
            -
              value: '3'
              newvalue: 'Pause pending'
            -
              value: '4'
              newvalue: 'Continue pending'
            -
              value: '5'
              newvalue: 'Stop pending'
            -
              value: '6'
              newvalue: Stopped
            -
              value: '7'
              newvalue: Unknown
            -
              value: '255'
              newvalue: 'No such service'
        -
          uuid: c80233756c9d43769f334d632da07b8c
          name: zabbix.host.available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
        -
          uuid: 5d3e53f3090448c7aaf081eb32b28ced
          name: 'Zabbix agent ping status'
          mappings:
            -
              value: '1'
              newvalue: Up
  triggers:
    -
      uuid: 8b1baeb26e154f99aefeaba3ea4fa63b
      expression: 'min(/Windows Agent Custom/perf_counter_en["\System\Processor Queue Length"],10m) - last(/Windows Agent Custom/wmi.get[root/cimv2,"Select NumberOfLogicalProcessors from Win32_ComputerSystem"]) * 2 > {$CPU.QUEUE.CRIT.MAX}'
      name: 'Длина очереди на каждое vCPU (queue length) выше {$CPU.QUEUE.CRIT.MAX} в течении 10 минут'
      opdata: 'Текущее значение: {ITEM.LASTVALUE1}'
      priority: HIGH
      description: 'PQL в течении 10 минут минус кол-во логических процессоров * 2. Например очередь 20 - 8*2 = 4 > 3. Не должна превышать на один vCPU значения от 2 до 10'
      tags:
        -
          tag: scope
          value: performance
    -
      uuid: 7c23e03060ce42b094aac2f8aea1a9ad
      expression: 'min(/Windows Agent Custom/system.swap.pfree,5m)<{$SWAP.PFREE.MIN.WARN} and last(/Windows Agent Custom/system.swap.size[,total])>0'
      name: 'Размер файла подкачки ниже {$SWAP.PFREE.MIN.WARN}% в течении 5 минут'
      opdata: 'Свободно: {ITEM.LASTVALUE1}, всего: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'Размер pfree (%) SWAP ниже значения и size больше 0'
      tags:
        -
          tag: scope
          value: performance
  graphs:
    -
      uuid: 0c2db401fe574282ab0beb6955049330
      name: CPU
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Processor Information(_total)\% User Time"]'
        -
          sortorder: '1'
          color: FFFF00
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Processor Information(_total)\% Privileged Time"]'
        -
          sortorder: '2'
          color: CC6600
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Processor Information(_total)\% Interrupt Time"]'
        -
          sortorder: '3'
          drawtype: BOLD_LINE
          color: FF0000
          item:
            host: 'Windows Agent Custom'
            key: system.cpu.util
    -
      uuid: 77a5588a3f2946ef82c7c373f62e9e94
      name: 'CPU Queue'
      graph_items:
        -
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\System\Processor Queue Length"]'
    -
      uuid: 3af1a7906a414dcfbf727c56c09762aa
      name: 'Memory and swap used'
      ymin_type_1: FIXED
      ymax_type_1: ITEM
      ymax_item_1:
        host: 'Windows Agent Custom'
        key: 'vm.memory.size[total]'
      graph_items:
        -
          drawtype: BOLD_LINE
          color: FF0000
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'vm.memory.size[used]'
        -
          sortorder: '1'
          drawtype: BOLD_LINE
          color: BF00FF
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: system.swap.free
        -
          sortorder: '2'
          color: BFFF00
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'system.swap.size[,total]'
    -
      uuid: 1b86c8f6fe3343e6838c5d02f4f64b2b
      name: 'Memory pages'
      graph_items:
        -
          color: 2774A4
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Memory\Page Faults/sec"]'
        -
          sortorder: '1'
          color: A54F10
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Memory\Pages/sec"]'
        -
          sortorder: '2'
          color: 00FF00
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'perf_counter_en["\Memory\Pool Nonpaged Bytes"]'
    -
      uuid: 9e4970840b4a42a2b73e32e2d92eb571
      name: 'Processes number'
      graph_items:
        -
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Windows Agent Custom'
            key: 'proc.num[]'
